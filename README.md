# Recursive Request Exploits (RRE)

âš ï¸ This research was presented at [DEF CON 33 (August 8th, 2025)](https://defcon.org/).
References: 
* DEF CON 33 Slides: [Paywall Optional: Stream for Free with a New Technique: RRE](https://media.defcon.org/DEF%20CON%2033/DEF%20CON%2033%20presentations/Farzan%20Karimi%20-%20Paywall%20Optional%20Stream%20for%20Free%20with%20a%20New%20Technique%2C%20Recursive%20Request%20Exploits%20%28RRE%29.pdf)
* WIRED article: https://www.wired.com/story/corporate-livestreams-exposed-search-tool/


![RRE Logo](media/rre-darkmode.png)

## âš¡TLDR

* Recursive Request Exploits (RRE) trace API chains backward from a protected resource (like a video stream) back to it's origin.
* If any upstream API is unauthenticated, the whole chain can be abused to bypass access
* This Burp extension automates this to find low-trust inputs that generate high-value outputs

## What Is an RRE?

Recursive Request Exploits (RRE) are a methodology for **recursively tracing interdependent web requests** to discover how digital entitlements (e.g., video streams) are generated â€” and where validation breaks down.

What makes RRE unique, and hard to detect, is that it follows the business logic of the app. Instead of attacking one endpoint or API, you recursively walk the entire stream of requests that led to a sensitive output. If any request in that chain isn't properly authenticated, the entire workflow can be compromised and an entitlement can be spoofed.

A hypothetical RRE workflow is demonstrated below:

![RRE Example Flow](https://cdn-images-1.medium.com/v2/resize:fit:960/1*ZYnpI2WfqxFAcgtuq_yF6A.png)

---
## ðŸ› ï¸ Installation

1. Clone the repo:
   ```bash
   git clone https://github.com/jumpycastle/rre-burp.git
   ``` 
2. In Burp Suite:
* Go to Extensions > Add
* Load the .py file manually
âœ… Python Jython required (Burp Professional with Jython support)


---
## RRE Usage

1. Launch Burp Suite Professional with your browser configured to use it as a proxy.
2. Load the RRE Extension via the Extensions tab. (Until itâ€™s in the BApp Store, you can import the Python code manually.)
3. Authenticate to the target app e.g., a hypothetical streaming service.
4. Navigate to the page that loads a protected resource, such as a video stream (.m3u8, .mp4, etc.).
5. Right-click the request in Burp and select the parameter tied to the entitlement (e.g., stream_id, see GIF below).
6. Go to Extensions > Output to view the recursive trace.
7. For vulnerable apps, youâ€™ll see a chain of unauthenticated or low-trust API calls that ultimately lead to a high-value response. The GIF below demonstrates the flow.

![RRE Full Trace GIF](media/rre-full-trace.gif)

8. Build your exploit chain by chaining together the discovered APIs using only the low-trust inputs. This simulates how a real attacker could bypass authentication by abusing the same business logic flow.
---

## Streamageddon

What happens when you scale this?

![Streamageddon GIF](media/streamageddon.gif)

---
## ðŸ›  Optional: Configure Shannon Entropy

RRE enumeration begins by identifying high-value outputs like stream tokens, access keys, or asset IDs. These are typically random-looking values with high Shannon entropy, indicating they were generated by the backend and are difficult to guess or forge.

By default, the RRE extension uses a **Shannon entropy threshold of 3.0** to flag potentially high-value parameters. This means any value with an entropy above 3.0 (bits/char) will be considered as a starting point for recursive tracing.

### What is Shannon Entropy?

Shannon entropy is a measure of randomness. In the context of web security, higher entropy often means a value is:

- Backend-generated
- Hard to predict or guess
- Likely tied to access controls or entitlements

The RRE extension highlights these values as potential targets for trace discovery, and then recursively looks up the next call to build a full trace.

For example:

| Value                             | Entropy (bits/char) | Likely Use                     |
|----------------------------------|----------------------|--------------------------------|
| `vod-abc123`                     | 2.85                 | Probably low-value metadata    |
| `vod_X3g1Vq94MPY7z9A.m3u8`       | 4.91                 | High-value stream ID ðŸŽ¯         |
| `public-event`                   | 2.32                 | Static slug / low trust input  |



### ðŸ”§ Customizing the Threshold

If youâ€™d like to adjust this threshold, you can edit the following line in the `rre_burp.py` file:

Code reference (see block 3):
![Shannon Entropy Threshold](https://cdn-images-1.medium.com/v2/resize:fit:640/1*DPK9cHcSennD01-fmELLDg.png)

and adjust the value:
```python
entropy > 3.0
```
# ðŸš€ RRE v2: Stream Finder

RRE v2 introduces Stream Finder, a lightweight helper module that improves the RRE workflow by automatically identifying streaming-related endpoints that are often good candidates for recursive request analysis.

Rather than manually searching Burpâ€™s full HTTP history, Stream Finder surfaces relevant media and manifest URLs in real time, allowing testers to move quickly from discovery to RRE enumeration.

## Whatâ€™s New in RRE v2

* Automatic stream discovery
Identifies common streaming manifests and media types (e.g., HLS/DASH manifests, progressive media, segments) observed in Proxy traffic.

* Configurable real-time filtering
Use Types [toggle] to enable or disable specific manifest or media types depending on what youâ€™re targeting â€” or leave all types enabled for broad discovery.

* One-click handoff to Repeater
Discovered candidates can be sent directly to Repeater as starting points for RRE chain discovery.

* Auth-signal annotations (heuristic)
During recursive chain discovery, RRE v2 provides best-effort auth-context signals to help analysts reason about trust boundaries. These signals are informational only and not definitive authentication checks.

* Burp-friendly design
Updated internals and conservative defaults to better align with Burp Suite BApp Store quality expectations, including bounded memory usage and improved UI responsiveness for large projects.

âš¡ Quick Start (RRE v2)

1. Load the latest RRE extension.

2. Browse the target application normally with Burp Proxy enabled.

3. Open the Stream Finder tab to observe discovered streaming-related endpoints.
Optionally, click *Types toggle* to narrow discovery to specific manifest or media types â€” or leave all types enabled for broad discovery.

4. Review discovered candidates and right-click â†’ Send to Repeater on a promising entry.

5. In Repeater, highlight a candidate entitlement or stream-related parameter.

6. Right-click and run RRE â†’ Full Chain Discovery to enumerate the recursive request chain.

7. Review the RRE Console output to identify low-trust inputs (e.g., non-auth related values) that lead to high-value outputs (e.g., video stream, entitlement).

